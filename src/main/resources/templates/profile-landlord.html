<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <div th:replace="layout :: head"></div>
    <link rel="stylesheet" th:href="@{custom-assets/css/profile.css}">
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
    <script async defer
            src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAT1IHF1gT-MK8Dsac6-9jeYv_pVjYuDyk&libraries=places">
    </script>
    <title>Quản lý tài khoản</title>
</head>
<body>

<div id="loading-wrapper">
    <div v-show="!isHidden" id="loader-login">
        <div class="preloader d-flex align-items-center justify-content-center">
            <div class="preloader-inner position-relative">
                <div class="preloader-circle"></div>
                <div class="preloader-img pere-text">
                    <b>Đang Lưu</b>
                </div>
            </div>
        </div>
    </div>
</div>

<!--    include confirm modal-->
<div th:replace="layout :: confirm-modal"></div>

<!--    include message modal-->
<div th:replace="layout :: message-modal"></div>

<!--    include notification modal-->
<div th:replace="layout :: notification"></div>

<!--    inlude processing loader screen-->
<div th:replace="layout :: processing-loader"></div>

<!--    inlude loading screen-->
<div th:replace="layout :: loader"></div>

<!--    include header-->
<header th:replace="layout :: header"></header>



<main>
    <div class="container-fluid">
        <!--        <div class="container">-->
        <div class="row">
            <div class="col-lg-3 d-none d-lg-block bg-light sidebar-left col-menu">

                <div th:replace="layout :: basic-user-infor"></div>

                <div th:replace="layout :: user-task"></div>

            </div>
            <div class="col-menu note" v-if="task == 13 || task == 16" id="note-wrapper">
                <div class="note-body">
                    <h4>Lưu ý khi đăng tin</h4>
                    <ul>
                        <li>Nội dung phải viết bằng tiếng Việt có dấu.</li>
                        <li>Tiêu đề tin không dài quá 100 kí tự.</li>
                        <li>Các bạn nên điền đầy đủ thông tin vào các mục để tin đăng có hiệu quả hơn.</li>
                        <li>Để tăng độ tin cậy và tin rao được nhiều người quan tâm hơn, hãy sửa vị trí tin rao của bạn trên bản đồ bằng cách kéo icon tới đúng vị trí của tin rao.</li>
                        <li>Tin đăng có hình ảnh rõ ràng sẽ được xem và gọi gấp nhiều lần so với tin rao không có ảnh. Hãy đăng ảnh để được giao dịch nhanh chóng!</li>
                    </ul>
                </div>
            </div>
            <div id="user-manager-content" class="col-9 sidebar-right col-table">
                <!-- Thông tin tài khoản -->
                <div th:replace="layout :: profile-user"></div>

                <!-- Đổi mật khẩu -->
                <div th:replace="layout :: change-password"></div>

            </div>

            <div id="landlord-manager" class="col sidebar-right col-table">

                <!-- Đăng tin -->
                <div v-if="task == 13 || task == 16" id="post-new-room">
                    <div class="title">
                        <h1 class="title-name uppercase" v-text="editMode ? 'Cập nhật bài đăng' : 'Đăng tin'"></h1>
                    </div>
                    <div class="container-fluid">
                        <div class="container">
                            <div class="fill-information col-lg-4">
                                <div class="title">
                                    <h4>Loại phòng<span class="require-text">*</span>
                                    </h4>

                                </div>

                                <div class="form-dropdown input-information">
                                    <select class="rounded-pill border-0 shadow-sm" v-model="typeOfPost">
                                        <option v-for="type in listTypePost" v-bind:value="type.id" v-text="type.name"></option>
                                    </select>
                                </div>
                            </div>
                            <div class="fill-information col-lg-12">
                                <div class="title">
                                    <h4>Tiêu đề (ít hơn 100 ký tự)<span class="require-text">*</span>
                                    </h4>
                                </div>
                                <div class="input-information">
                                    <input type="text" v-model="title" class="form-input-title-information rounded-pill border-0 shadow-sm">
                                </div>
                            </div>
                            <div class="fill-information col-lg-12">
                                <div class="title">
                                    <h4>Thông tin chi tiết<span class="require-text">*</span>
                                    </h4>
                                </div>
                                <div class="input-information">
                                    <textarea v-model="detailInfo" class="rounded-pill border-0 shadow-sm"></textarea>
                                </div>
                            </div>
                            <div class="row">
                                <div class="fill-information col-lg-6">
                                    <div class="title">
                                        <h4>Số lượng phòng<span class="require-text">*</span>
                                        </h4>
                                    </div>
                                    <div class="input-information">
                                        <input v-if="editMode" disabled type="number" min="0" max="100" v-model="selectedPost.roomNumber" class="form-input-information  rounded-pill border-0 shadow-sm">
                                        <input v-else @keypress="removeDot(numberOfRoom, 'int', $event)" type="text" maxlength="2" @change="generateRooms" v-model="numberOfRoom" class="form-input-information rounded-pill border-0 shadow-sm">

                                    </div>
                                </div>
                                <div class="col-lg-6">
                                    <div class="input-group-append btn-add-container" v-if="editMode">
                                        <button class="btn-hover btn-add-room" v-on:click="showAddRoomModal()">Thêm Phòng</button>
                                    </div>
                                </div>
                            </div>

                            <div class="fill-information col-lg-12" v-if="(listRoom != undefined && listRoom.length > 0) || (listRoomRequest != undefined && listRoomRequest.length > 0)">
                                <div class="title">
                                    <h4>Trạng thái các phòng<span class="require-text">*</span>
                                    </h4>
                                </div>
                                <div class="input-information table-wrapper">
                                    <table class="table tbl-room table-bordered">
                                        <thead class="thead-light">
                                        <tr>
                                            <th scope="col">STT</th>
                                            <th scope="col">Phòng</th>
                                            <th scope="col">Trạng thái</th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        <tr v-for="(room, index) in editMode ? listRoomRequest : listRoom">
                                            <th scope="row" v-text="index + 1"></th>
                                            <th scope="row" v-text="editMode ? room.name : room.roomName"></th>
                                            <th scope="row">
                                                <span>Đã cho thuê</span>
                                                <label class="switch">
                                                    <input type="checkbox" v-if="editMode" v-on:click.prevent="handleChangeRoomStatus(room, index)" v-model="room.status.id == 1">
                                                    <input type="checkbox" v-else v-model="room.availableRoom">
                                                    <span class="slider round"></span>
                                                </label>
                                                <span>Còn trống</span>
                                            </th>
                                        </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                            <div class="fill-information col-lg-6">
                                <div class="title">
                                    <h4>Giá cho thuê<span class="require-text">*</span>
                                    </h4>
                                </div>
                                <div class="input-information">
                                    <input type="text" maxlength="9" @keypress="removeDot(price, 'int', $event)" v-model="price" class="hide-arrow form-input-information width-80-pct rounded-pill border-0 shadow-sm">
                                    <div class="input-group-append">
                                        <span>VNĐ</span>
                                    </div>

                                </div>
                            </div>
                            <div class="fill-information col-lg-6">
                                <div class="title">
                                    <h4>Diện tích<span class="require-text">*</span>
                                    </h4>
                                </div>
                                <div class="input-information">
                                    <input type="text" maxlength="3" @keypress="removeDot(square, 'float', $event)" v-model="square" class="form-input-information width-80-pct rounded-pill border-0 shadow-sm">
                                    <div class="input-group-append">
                                        <span>M&sup2</span>
                                    </div>
                                </div>


                            </div>
                            <div class="fill-information col-lg-6">
                                <div class="title">
                                    <h4>Khoảng cách (So với Đại Học FPT)<span class="require-text">*</span>
                                    </h4>
                                </div>
                                <div class="input-information">
                                    <input type="text" maxlength="4" @keypress="removeDot(distance, 'float', $event)" v-model="distance" class="form-input-information width-80-pct rounded-pill border-0 shadow-sm">
                                    <div class="input-group-append">
                                        <span>KM</span>
                                    </div>
                                </div>
                            </div>
                            <div class="fill-information col-lg-12">
                                <div class="title">
                                    <h4>Địa chỉ<span class="require-text">*</span>
                                    </h4>
                                </div>
                                <div class="input-information">
                                    <input type="text" v-model="inputAddress" class="form-input-title-information rounded-pill border-0 shadow-sm">
                                </div>
                            </div>

                            <div class="fill-information col-lg-12">
                                <div class="title">
                                    <h4>Bản đồ<span class="require-text">*</span>
                                    </h4>
                                </div>

                                <input type="hidden" id="latitude">
                                <input type="hidden" id="longitude">
                                <div class="map-container">
                                    <div class="input-information map-search">
                                        <input id="map-search" placeholder="Tìm kiếm" type="text" class="form-input-information rounded-pill border-0 shadow-sm">
                                        <i class="fas icon-search-map fa-search"></i>
                                    </div>
                                    <div id="map-canvas"></div>
                                </div>

                            </div>



                            <div class="fill-information col-lg-12">
                                <div class="title">
                                    <h4>Hình ảnh (tối thiểu 3 hình, tối đa 10 hình)<span class="require-text">*</span>
                                    </h4>
                                </div>
                                <div class="input-information">
                                    <div class="upload-file" v-on:click="openFileDialog">
                                        <img class="upload-image" src="assets/img/logo/upload.png"/>
                                    </div>
                                    <input type="file" id="file-browse" style="display: none" multiple @change="processFile"/>
                                </div>
                                <div class="list-image input-information" v-show="uploadImages != undefined && uploadImages.length > 0">
                                    <div class="image-item" v-for="image in uploadImages">
                                        <div class="image">
                                            <img v-bind:src="image">
                                            <i v-on:click="removeImage(image)" class="fas fa-times-circle"></i>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="fill-information col-lg-12" v-bind:class="{flexElement: editMode}">
                                <div class="title" v-show="!editMode">
                                    <h4>Thời hạn bài đăng<span class="require-text">*</span>
                                    </h4>
                                </div>
                                <div class="input-information" v-show="!editMode">
                                    <div class="form-check-inline" v-for="package in listPaymentPackage">
                                        <label class="radio-container">
                                            {{package.duration + ' tháng'}}
                                            <input v-model="duration" type="radio" @change="calculateCost(package)" name="duration" v-bind:value="package.id">
                                            <span class="checkmark"></span>
                                        </label>
                                    </div>

                                </div>
                                <div class="date-time-box col-6" v-show="editMode">
                                    <span v-text="'Bài đăng có thời hạn đến: ' + expireDate"></span>
                                </div>
                                <div class="date-time-box col-6" v-show="editMode">
                                    <button class="btn-hover btn-extend" v-on:click="showModalExtend()">Gia hạn bài đăng</button>
                                </div>
                            </div>
                            <div v-show="!editMode" class="fill-information" v-if="duration != 0">
                                <div class="title">
                                    <h4>Thông tin thanh toán</h4>
                                </div>
                                <div class="input-information">
                                    <div id="table-checkout" class="table-checkout">
                                        <table>
                                            <tr>
                                                <td>Thành tiền:</td>
                                                <td class="money-col" v-text="authenticationInstance.formatNumberToDisplay(amountSelected) + ' VNĐ'"></td>
                                            </tr>
                                            <tr>
                                                <td>Tài khoản:</td>
                                                <td class="money-col" v-text="authenticationInstance.formatNumberToDisplay(userInfo.amount) + ' VNĐ'"></td>
                                            </tr>
                                            <tr>
                                                <td>Số dư:</td>
                                                <td class="money-col" v-text="authenticationInstance.formatNumberToDisplay(userInfo.amount - amountSelected) + ' VNĐ'"></td>
                                            </tr>
                                        </table>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-12">
                                <div class="msg-notification">
                                    <img v-if="showMsg" width="24px" src="assets/img/logo/error.png"/>

                                    <span v-if="showMsg" v-html="validateMessage">

                                    </span>
                                </div>
                            </div>
                            <div class="col-lg-6 m-auto">
                                <button class="btn-hover btn-complete" v-on:click="handleAddNewPost">Hoàn thành</button>
                            </div>

                            <div class="title col-lg-8">
                                <h4>Bảng giá tham khảo</h4>
                            </div>
                            <div class="col-lg-8" id="table-price">
                                <table class="table">
                                    <thead class="thead-light">
                                    <tr>
                                        <th scope="col">Gói</th>
                                        <th scope="col">Thời hạn</th>
                                        <th scope="col">Giá</th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    <tr v-for="package in listPaymentPackage">
                                        <th scope="row" v-text="package.packageName"></th>
                                        <th scope="row" v-text="package.duration + ' Tháng'"></th>
                                        <th scope="row" v-text="authenticationInstance.formatNumberToDisplay(package.amount) + ' VND'"></th>
                                    </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>


                <!--                 Lịch sử nạp tiền-->
                <div v-if="task == 6">
                    <div class="title">
                        <h1 class="title-name uppercase">Lịch sử nạp tiền</h1>
                    </div>
                    <div class="information-detail" id="history-payment">
                        <table class="table table-bordered table-hover">
                            <thead class="thead-light">
                            <tr>
                                <th>Ngày giao dịch</th>
                                <th>Số tiền</th>
                                <th>Phương thức thanh toán</th>
                                <th>Momo ID</th>
                                <th>Ghi chú</th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr v-for="payment in listPayment">
                                <td v-text="authenticationInstance.formatDate(payment.payDate)"></td>
                                <td v-text="authenticationInstance.formatNumberToDisplay(payment.amount) + ' VNĐ'"></td>
                                <td v-text="payment.paymentMethod"></td>
                                <td v-text="payment.momoId"></td>
                                <td v-text="payment.note"></td>
                            </tr>
                            </tbody>
                        </table>
                        <nav v-if="pagination.totalPages != 1 && listPayment.length > 0" aria-label="Page navigation">
                            <ul class="pagination justify-content-center">
                                <li v-bind:class="{disabled : !pagination.hasPrevious}"
                                    class="page-item">
                                    <a v-on:click="getHistoryPayment(pagination.currentPage-1)"
                                       v-bind:class="{'text-primary' : pagination.hasPrevious}" class="page-link"
                                       aria-label="Previous">
                                        <span aria-hidden="true">&laquo;</span>
                                        <span class="sr-only">Previous</span>
                                    </a>
                                </li>
                                <li v-for="page in pagination.totalPages"
                                    v-bind:class="{active : page == pagination.currentPage+1}" class="page-item"
                                    v-on:click="getHistoryPayment(page-1)">
                                    <a class="page-link">{{page}}</a>
                                </li>
                                <li v-bind:class="{disabled : !pagination.hasNext}"
                                    class="page-item">
                                    <a v-on:click="getHistoryPayment(pagination.currentPage+1)"
                                       v-bind:class="{'text-primary' : pagination.hasNext}" class="page-link"
                                       aria-label="Next">
                                        <span aria-hidden="true">&raquo;</span>
                                        <span class="sr-only">Next</span>
                                    </a>
                                </li>
                            </ul>
                        </nav>
                        <div v-if="listPayment.length == 0">Không có lịch sử nạp tiền nào.</div>
                    </div>
                </div>

                <!--                    Quản lý bài đăng-->
                <div v-if="task == 4">
                    <div class="title">
                        <h1 class="title-name uppercase">Quản lý bài đăng</h1>
                    </div>
                    <div class="information-detail">
                        <table class="table table-bordered table-hover">
                            <thead class="thead-light">
                            <tr>
                                <th scope="col">STT</th>
                                <th scope="col">Tên bài đăng</th>
                                <th scope="col">Số phòng</th>
                                <th scope="col">Ngày đăng</th>
                                <th scope="col">Ngày hết hạn</th>
                                <th scope="col">Tình trạng</th>
                                <th scope="col">Tác vụ</th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr v-for="(post, index) in listPost">

                                <th scope="row" v-text="index + 1"></th>
                                <td><a v-bind:href="'/post-detail?id=' + post.id" v-text="post.title" target="_blank"></a></td>
                                <td>
                                    <i class="fas fa-eye" v-on:click="handleViewRoom(post)" data-toggle="tooltip" data-html="true" title="Xem phòng"></i>
                                    <span v-text="post.roomNumber"></span>
                                </td>

                                <td v-text="authenticationInstance.formatDate(post.createDate)"></td>
                                <td v-text="authenticationInstance.formatDate(post.expireDate)"></td>
                                <td>
                                    <div v-bind:class="post.visible && !post.banned && !authenticationInstance.IsExpirePost(post.expireDate) ? 'status-show' : 'status-hide'" v-text="authenticationInstance.getStatusPost(post.visible, post.banned, post.expireDate)"></div>
                                </td>
                                <td>
                                    <i class="fas fa-edit" v-on:click="handleEditPost(post)" data-toggle="tooltip" data-html="true" title="Chỉnh sửa"></i>
                                    <i class="fas fa-trash-alt" v-on:click="showModalConfirm(post, 'delete')" data-toggle="tooltip" data-html="true" title="Xóa bài viết"></i>
                                    <i v-bind:class="{'fa-eye-slash' : post.visible, 'fa-eye' : !post.visible}" class="fas"  v-on:click="showModalConfirm(post, 'hide')" data-toggle="tooltip" data-html="true" v-bind:title="post.postVisible ? 'Ẩn bài viết' : 'Hiển thị bài viết'"></i>
                                    <i @click="showModalExtend(post, index)" class="far fa-calendar-plus" data-toggle="tooltip" data-html="true" title="Gia hạn bài đăng"></i>

                                </td>
                            </tr>

                            </tbody>
                        </table>
                        <nav v-if="pagination.totalPages != 1 && listPost.length > 0" aria-label="Page navigation">
                            <ul class="pagination justify-content-center">
                                <li v-bind:class="{disabled : !pagination.hasPrevious}"
                                    class="page-item">
                                    <a v-on:click="viewListPost(pagination.currentPage-1)"
                                       v-bind:class="{'text-primary' : pagination.hasPrevious}" class="page-link"
                                       aria-label="Previous">
                                        <span aria-hidden="true">&laquo;</span>
                                        <span class="sr-only">Previous</span>
                                    </a>
                                </li>
                                <li v-for="page in pagination.totalPages"
                                    v-bind:class="{active : page == pagination.currentPage+1}" class="page-item"
                                    v-on:click="viewListPost(page-1)">
                                    <a class="page-link">{{page}}</a>
                                </li>
                                <li v-bind:class="{disabled : !pagination.hasNext}"
                                    class="page-item">
                                    <a v-on:click="viewListPost(pagination.currentPage+1)"
                                       v-bind:class="{'text-primary' : pagination.hasNext}" class="page-link"
                                       aria-label="Next">
                                        <span aria-hidden="true">&raquo;</span>
                                        <span class="sr-only">Next</span>
                                    </a>
                                </li>
                            </ul>
                        </nav>
                        <div v-if="listPost.length == 0">Không có bài đăng nào.</div>
                    </div>
                </div>

                <!--   Lịch sử thanh toán-->
                <div v-if="task == 7">
                    <div class="title">
                        <h1 class="title-name uppercase">Lịch sử thanh toán</h1>
                    </div>
                    <div class="information-detail">
                        <table class="table table-bordered table-hover">
                            <thead class="thead-light">
                            <tr>
                                <th>Bài đăng</th>
                                <th>Ngày giao dịch</th>
                                <th>Gói</th>
                                <th>Số tiền</th>
                                <th>Thời hạn</th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr v-for="paymentPost in listPaymentPost">
                                <td><a v-bind:href="'/post-detail?id=' + paymentPost.postPayment.id" v-text="paymentPost.postPayment.title"></a> </td>
                                <td v-text="authenticationInstance.formatDate(paymentPost.payDate)"></td>
                                <td v-text="paymentPost.paymentPackage.packageName"></td>
                                <td v-text="authenticationInstance.formatNumberToDisplay(paymentPost.paymentPackage.amount) + ' VNĐ'"></td>
                                <td v-text="paymentPost.paymentPackage.duration + ' Tháng'"></td>
                            </tr>
                            </tbody>
                        </table>
                        <nav v-if="pagination.totalPages != 1 && listPaymentPost.length > 0"
                             aria-label="Page navigation">
                            <ul class="pagination justify-content-center">
                                <li v-bind:class="{disabled : !pagination.hasPrevious}"
                                    class="page-item">
                                    <a v-on:click="getHistoryPaymentPost(pagination.currentPage-1)"
                                       v-bind:class="{'text-primary' : pagination.hasPrevious}" class="page-link"
                                       aria-label="Previous">
                                        <span aria-hidden="true">&laquo;</span>
                                        <span class="sr-only">Previous</span>
                                    </a>
                                </li>
                                <li v-for="page in pagination.totalPages"
                                    v-bind:class="{active : page == pagination.currentPage+1}" class="page-item"
                                    v-on:click="getHistoryPaymentPost(page-1)">
                                    <a class="page-link">{{page}}</a>
                                </li>
                                <li v-bind:class="{disabled : !pagination.hasNext}"
                                    class="page-item">
                                    <a v-on:click="getHistoryPaymentPost(pagination.currentPage+1)"
                                       v-bind:class="{'text-primary' : pagination.hasNext}" class="page-link"
                                       aria-label="Next">
                                        <span aria-hidden="true">&raquo;</span>
                                        <span class="sr-only">Next</span>
                                    </a>
                                </li>
                            </ul>
                        </nav>
                        <div v-if="listPaymentPost.length == 0">Không có lịch sử thanh toán nào.</div>
                    </div>
                </div>
                <!-- Quản lý phòng -->

                <div id="room-manager" v-if="task == 15">
                    <div class="title">
                        <h1 class="title-name uppercase">Quản lý phòng</h1>
                    </div>
                    <div class="information-detail">
                        <table class="table table-bordered table-hover">
                            <thead class="thead-light">
                            <tr>
                                <th  width="2%"></th>
                                <th  width="2%">STT</th>
                                <th  width="30%">Tên phòng trọ</th>
                                <th  width="21%">Phòng</th>
                                <th  width="15%">Tình trạng</th>
                                <th width="10%"></th>
                                <th  width="20%">Yêu cầu thuê phòng</th>
                            </tr>
                            </thead>
                            <tbody>
                            <template v-for="(room, index) in listRoomRequest">
                                <tr>
                                    <td>
                                        <i class="fas fa-angle-double-down" v-if="!room.openCollapse" v-on:click="getListRequestByRoom(room, index)" v-bind:class="{invisible: room.requestNumber == 0}"></i>
                                        <i class="fas fa-angle-double-right" v-else v-on:click="getListRequestByRoom(room, index)" v-bind:class="{invisible: room.requestNumber == 0}"></i>
                                    </td>
                                    <td v-text="index + 1"></td>
                                    <td><a v-bind:href="'/post-detail?id=' + room.postRoom.id" v-text="room.postRoom.title"></a></td>
                                    <td v-text="room.name"></td>
                                    <td v-text="room.status.status"></td>
                                    <td>
                                        <label class="switch" data-toggle="tooltip" data-html="true" title="Thay đổi trạng thái">
                                            <input type="checkbox" v-on:click.prevent="handleChangeRoomStatus(room, index)" v-model="room.status.id == 1">
                                            <span class="slider round"></span>
                                        </label>
                                    </td>
                                    <td v-text="room.requestNumber"></td>

                                </tr>

                                <tr v-bind:id="room.id" v-show="room.requestNumber > 0" class="request-collapse" v-bind:class="{requestCollapseShow : room.openCollapse}">
                                    <td colspan="7" v-if="room.openCollapse">
                                        <table class="collapse-table table-bordered table-hover">
                                            <thead class="thead-light">
                                            <tr>
                                                <th width="2%">STT</th>
                                                <th width="25%">Tên người thuê</th>
                                                <th width="15%">Ngày yêu cầu</th>
                                                <th width="15%">Ngày bắt đầu</th>
                                                <th width="15%">Trạng thái</th>
                                                <th width="26%">Tác vụ</th>
                                            </tr>
                                            </thead>
                                            <tbody>
                                            <tr v-for="(request, index) in room.listRentalRequest">
                                                <td v-text="index + 1"></td>
                                                <td>
                                                    <a class="pointer-enable" v-on:click="getRenterInfo(request.rentalRenter.username, true)" v-text="request.rentalRenter.username"></a>
                                                </td>
                                                <td v-text="authenticationInstance.formatDate(request.requestDate)"></td>
                                                <td v-text="authenticationInstance.formatDate(request.startDate, true)"></td>
                                                <td v-text="request.rentalStatus.status"></td>
                                                <td>
                                                    <button v-if="request.rentalStatus.id == 7" v-on:click="handleProcessRequest(room, request, 'accept')" class="table-button">Chấp nhận</button>
                                                    <button v-if="request.rentalStatus.id == 7" v-on:click="handleProcessRequest(room, request, 'reject')" class="table-button">Từ chối</button>
                                                </td>
                                            </tr>
                                            </tbody>
                                        </table>
                                    </td>
                                </tr>
                            </template>

                            </tbody>
                        </table>
                        <nav v-if="pagination.totalPages != 1 && listRoomRequest.length > 0"
                             aria-label="Page navigation">
                            <ul class="pagination justify-content-center">
                                <li v-bind:class="{disabled : !pagination.hasPrevious}"
                                    class="page-item">
                                    <a v-on:click="getListRoomPaging(pagination.currentPage-1)"
                                       v-bind:class="{'text-primary' : pagination.hasPrevious}" class="page-link"
                                       aria-label="Previous">
                                        <span aria-hidden="true">&laquo;</span>
                                        <span class="sr-only">Previous</span>
                                    </a>
                                </li>
                                <li v-for="page in pagination.totalPages"
                                    v-bind:class="{active : page == pagination.currentPage+1}" class="page-item"
                                    v-on:click="getListRoomPaging(page-1)">
                                    <a class="page-link">{{page}}</a>
                                </li>
                                <li v-bind:class="{disabled : !pagination.hasNext}"
                                    class="page-item">
                                    <a v-on:click="getListRoomPaging(pagination.currentPage+1)"
                                       v-bind:class="{'text-primary' : pagination.hasNext}" class="page-link"
                                       aria-label="Next">
                                        <span aria-hidden="true">&raquo;</span>
                                        <span class="sr-only">Next</span>
                                    </a>
                                </li>
                            </ul>
                        </nav>

                    </div>
                </div>

                <!-- Quản lý yêu cầu -->

                <div id="request-manager" v-if="task == 5 || task == 17">
                    <div class="title">
                        <h1 class="title-name uppercase" v-text="task == 5 ? 'Quản lý yêu cầu' : 'Quản lý phòng'"></h1>
                    </div>
                    <div class="information-detail">
                        <div v-if="listRoomRequest == null || listRoomRequest.length == 0">
                            <span>Không có yêu cầu thuê trọ nào</span>
                        </div>
                        <table v-else class="table table-bordered table-hover">
                            <thead class="thead-light">
                            <tr v-if="task == 5">
                                <th  width="2%"></th>
                                <th  width="2%">STT</th>
                                <th  width="48%">Tên phòng trọ</th>
                                <th  width="28%">Phòng</th>
                                <th  width="20%">Yêu cầu thuê phòng</th>
                            </tr>
                            <tr v-else-if="task == 15 || task == 17">
                                <th  width="2%"></th>
                                <th  width="2%">STT</th>
                                <th  width="30%">Tên phòng trọ</th>
                                <th  width="21%">Phòng</th>
                                <th  width="15%">Tình trạng</th>
                                <th width="10%"></th>
                                <th  width="20%">Yêu cầu thuê phòng</th>
                            </tr>
                            </thead>
                            <tbody>
                            <template v-for="(room, index) in listRoomRequest">
                                <tr>
                                    <td>
                                        <i class="fas fa-angle-double-down" v-if="!room.openCollapse" v-on:click="getListRequestByRoom(room, index, 7)" v-bind:class="{invisible: room.requestNumber == 0}"></i>
                                        <i class="fas fa-angle-double-right" v-else v-on:click="getListRequestByRoom(room, index, 7)" v-bind:class="{invisible: room.requestNumber == 0}"></i>
                                    </td>
                                    <td v-text="index + 1"></td>
                                    <td><a v-bind:href="'/post-detail?id=' + room.postRoom.id" v-text="room.postRoom.title"></a></td>
                                    <td v-text="room.name"></td>
                                    <td v-if="task == 15  || task == 17" v-text="room.status.status"></td>
                                    <td v-if="task == 15  || task == 17">
                                        <label class="switch">
                                            <input type="checkbox" v-on:click.prevent="handleChangeRoomStatus(room, index)" v-model="room.status.id == 1">
                                            <span class="slider round"></span>
                                        </label>
                                    </td>
                                    <td v-text="room.requestNumber"></td>

                                </tr>

                                <tr v-bind:id="room.roomId" v-show="room.requestNumber > 0" class="request-collapse" v-bind:class="{requestCollapseShow : room.openCollapse}">
                                    <td v-bind:colspan="task == 5 ? 5 : 7" v-if="room.openCollapse">
                                        <table class="collapse-table table-bordered table-hover">
                                            <thead class="thead-light">
                                            <tr>
                                                <th width="2%">STT</th>
                                                <th width="25%">Tên người thuê</th>
                                                <th width="15%">Ngày yêu cầu</th>
                                                <th width="15%">Ngày bắt đầu</th>
                                                <th width="15%">Trạng thái</th>
                                                <th width="26%" class="message-col" v-text="task == 17 && room.listRentalRequest[0].statusId == 11 ? 'Lời nhắn' : 'Tác vụ'"></th>
                                            </tr>
                                            </thead>
                                            <tbody>
                                            <tr v-for="(request, index) in room.listRentalRequest">
                                                <td v-text="index + 1"></td>
                                                <td>
                                                    <a class="pointer-enable" v-on:click="getRenterInfo(request.rentalRenter.username)" v-text="request.rentalRenter.username"></a>
                                                </td>
                                                <td v-text="authenticationInstance.formatDate(request.requestDate)"></td>
                                                <td v-text="authenticationInstance.formatDate(request.startDate, true)"></td>
                                                <td v-text="request.rentalStatus.status"></td>
                                                <td>
                                                    <button v-if="request.rentalStatus.id == 7" v-on:click="handleProcessRequest(room, request, 'accept')" class="table-button">Chấp nhận</button>
                                                    <button v-if="request.rentalStatus.id == 7" v-on:click="handleProcessRequest(room, request, 'reject')" class="table-button">Từ chối</button>
                                                    <button v-if="request.rentalStatus.id == 11 && request.expireMessage != null && request.expireMessage.length > 60 && task == 17" v-on:click="showExpireMessage(request)" class="table-button"
                                                            data-toggle="tooltip" data-html="true" title="Xem lời nhắn của người thuê">Lời nhắn</button>
                                                    <p v-else-if="request.rentalStatus.id == 11 && request.expireMessage != null && request.expireMessage.length <= 60 && task == 17" v-text="request.expireMessage"> </p>
                                                </td>
                                            </tr>
                                            </tbody>
                                        </table>
                                    </td>
                                </tr>
                            </template>

                            </tbody>
                        </table>
                        <nav v-if="pagination.totalPages != 1 && listRoomRequest.length > 0"
                             aria-label="Page navigation">
                            <ul class="pagination justify-content-center">
                                <li v-bind:class="{disabled : !pagination.hasPrevious}"
                                    class="page-item">
                                    <a v-on:click="getListRoomPaging(pagination.currentPage-1)"
                                       v-bind:class="{'text-primary' : pagination.hasPrevious}" class="page-link"
                                       aria-label="Previous">
                                        <span aria-hidden="true">&laquo;</span>
                                        <span class="sr-only">Previous</span>
                                    </a>
                                </li>
                                <li v-for="page in pagination.totalPages"
                                    v-bind:class="{active : page == pagination.currentPage+1}" class="page-item"
                                    v-on:click="getListRoomPaging(page-1)">
                                    <a class="page-link">{{page}}</a>
                                </li>
                                <li v-bind:class="{disabled : !pagination.hasNext}"
                                    class="page-item">
                                    <a v-on:click="getListRoomPaging(pagination.currentPage+1)"
                                       v-bind:class="{'text-primary' : pagination.hasNext}" class="page-link"
                                       aria-label="Next">
                                        <span aria-hidden="true">&raquo;</span>
                                        <span class="sr-only">Next</span>
                                    </a>
                                </li>
                            </ul>
                        </nav>
                    </div>
                </div>
                <!--   Modal extend -->
                <div id="myModal_Extend" class="modal">
                    <!-- Modal content -->
                    <div class="view-information" v-if="editMode">
                        <div class="modal-header">
                            <h2>Gia hạn bài đăng</h2>
                            <span @click="closeModalExtend()" class="close">&times;</span>
                        </div>
                        <div class="modal-body">
                            <div class="fill-information">
                                <div class="title">
                                    <h4>Thời hạn bài đăng<span class="require-text">*</span></h4>
                                </div>
                                <div class="input-information">
                                    <div class="form-check-inline col" v-for="package in listPaymentPackage">
                                        <label class="radio-container">
                                            {{package.duration + ' tháng'}}
                                            <input v-model="duration" type="radio" @change="calculateCost(package)" name="duration" v-bind:value="package.id">
                                            <span class="checkmark"></span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <div class="fill-information" v-if="duration != 0">
                                <div class="title">
                                    <h4>Thông tin thanh toán</h4>
                                </div>
                                <div class="input-information">
                                    <div id="table-checkout-modal" class="table-checkout">
                                        <table>
                                            <tr>
                                                <td>Thành tiền:</td>
                                                <td class="money-col" v-text="authenticationInstance.formatNumberToDisplay(amountSelected) + ' VNĐ'"></td>
                                            </tr>
                                            <tr>
                                                <td>Tài khoản:</td>
                                                <td class="money-col" v-text="authenticationInstance.formatNumberToDisplay(userInfo.amount) + ' VNĐ'"></td>
                                            </tr>
                                            <tr>
                                                <td>Số dư:</td>
                                                <td class="money-col" v-text="authenticationInstance.formatNumberToDisplay(userInfo.amount - amountSelected) + ' VNĐ'"></td>
                                            </tr>
                                        </table>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-12">
                                <div class="msg-notification">
                                    <img v-if="showMsgModal" width="24px" src="assets/img/logo/error.png"/>

                                    <span v-if="showMsgModal" v-html="validateMessage">

                                    </span>
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button @click="extendTimePost()" class="btn-hover btn-default">Xác Nhận</button>
                        </div>
                    </div>
                </div>

                <!--   Modal add rooms -->
                <div id="myModal_AddRoom" class="modal">
                    <!-- Modal content -->
                    <div class="view-information" v-if="editMode">
                        <div class="modal-header">
                            <h2>Thêm phòng</h2>
                            <span @click="closeModalAddRoom()" class="close">&times;</span>
                        </div>
                        <div class="modal-body">
                            <div class="fill-information">
                                <div class="title">
                                    <h4>Số lượng phòng<span class="require-text">*</span></h4>
                                </div>
                                <div class="input-information">
                                    <input @keypress="removeDot(numberOfRoom, 'int', $event)" type="text" maxlength="2" @change="generateRooms" v-model="numberOfRoom" class="form-input-information half-width rounded-pill border-0 shadow-sm">
                                </div>
                            </div>
                            <div class="fill-information" v-if="listRoom != undefined && listRoom.length > 0">
                                <div class="title">
                                    <h4>Trạng thái các phòng:</h4>
                                </div>
                                <div class="input-information table-wrapper">
                                    <table class="table tbl-room table-bordered">
                                        <thead class="thead-light">
                                        <tr>
                                            <th scope="col">STT</th>
                                            <th scope="col">Phòng</th>
                                            <th scope="col">Trạng thái</th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        <tr v-for="(room, index) in listRoom">
                                            <th scope="row" v-text="index + 1"></th>
                                            <th scope="row" v-text="room.roomName"></th>
                                            <th scope="row">
                                                <span>Đã cho thuê</span>
                                                <label class="switch">
                                                    <input type="checkbox" v-model="room.availableRoom">
                                                    <span class="slider round"></span>
                                                </label>
                                                <span>Còn trống</span>
                                            </th>
                                        </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                            <div class="col-lg-12">
                                <div class="msg-notification">
                                    <img v-if="showMsgModal" width="24px" src="assets/img/logo/error.png"/>

                                    <span v-if="showMsgModal" v-html="validateMessage">

                                    </span>
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button @click="increaseRoom()" class="btn-hover btn-default">Xác nhận</button>
                        </div>
                    </div>
                </div>

                <!--Modal user detail-->
                <div id="modalUserDetail" class="modal">
                    <!-- Modal content -->
                    <div class="view-information">
                        <div class="modal-header">
                            <h2>Thông tin người dùng</h2>
                            <span id="closeModalUserDetail" @click="closeModalUserDetail" class="close">&times;</span>
                        </div>
                        <div class="modal-body">
                            <div class="infor-modal">
                                <p class="left-modal">Tên đăng nhập:</p>
                                <input :value="renterInfo.username"
                                       class="right-modal rounded-pill border-0 shadow-sm"
                                       type="text" disabled/>
                            </div>
                            <div class="infor-modal">
                                <p class="left-modal">Tên hiển thị:</p>
                                <input :value="renterInfo.displayName"
                                       class="right-modal rounded-pill border-0 shadow-sm"
                                       type="text" disabled/>
                            </div>
                            <div class="infor-modal">
                                <p class="left-modal">Số điện thoại:</p>
                                <input :value="renterInfo.phoneNumber"
                                       class="right-modal rounded-pill border-0 shadow-sm"
                                       type="text" disabled/>
                            </div>
                            <div class="infor-modal">
                                <p class="left-modal">Ngày sinh:</p>
                                <input :value="authenticationInstance.formatDate(renterInfo.dob, true)" class="right-modal rounded-pill border-0 shadow-sm"
                                       type="text" disabled/>
                            </div>
                            <div class="infor-modal">
                                <p class="left-modal">Nghề nghiệp:</p>
                                <input class="right-modal rounded-pill border-0 shadow-sm"
                                       type="text" :value="renterInfo.career" disabled/>
                            </div>
                            <div class="infor-modal">
                                <p class="left-modal">Giới tính:</p>
                                <input class="right-modal rounded-pill border-0 shadow-sm"
                                       type="text" :value="renterInfo.gender ? 'Nam' : 'Nữ'" disabled/>
                            </div>

                        </div>
                        <div class="modal-footer">
                            <button class="btn-hover btn-default" @click="closeModalUserDetail">Xác Nhận</button>
                        </div>
                    </div>
                </div>

                <!--Modal rental request detail-->
                <div th:replace="layout :: modal-request-detail"></div>

                <!--Nạp tiền -->

                <!--nạp tiền-->
                <div id="paymentPage" v-if="task == 8">
                    <div class="title">
                        <h1 class="title-name uppercase">Nạp tiền</h1>
                    </div>
                    <div class="container payment-container">
                        <div class="row payment-method">
                            <div class="col-lg-4">
                                <div>
                                    <img class="img-logo-payment"
                                         src="/assets/img/logo/logo-momo.jpg">
                                </div>
                            </div>
                            <div class="col-lg-8">
                                <p id="notify_paymentAmount" class="invisible" style="color: red;">

                                </p>
                                <div class="fill-information">
                                    <div class="title">
                                        <h4>Số tiền<span class="require-text">*</span></h4>
                                    </div>

                                    <div class="input-information">
                                        <input @keypress="removeDot(paymentAmount, 'float', $event)" id="paymentAmountTxt" @input="paymentAmount = $event.target.value" type="text" placeholder="10.000 vnđ"
                                               class="form-input-information rounded-pill border-0 shadow-sm">
                                    </div>
                                </div>

                                <div class="fill-information">
                                    <div class="m-auto" style="width: fit-content">
                                        <button v-on:click="checkPaymentAmount" class="btn">
                                            Thanh Toán
                                        </button>
                                    </div>
                                </div>
                            </div>

                        </div>
                        <div class="row payment-method">
                            <div class="col-lg-4">
                                <div>
                                    <img class="img-logo-payment"
                                         src="/assets/img/logo/money-transfer-banking.jpg">
                                </div>
                            </div>
                            <div class="col-lg-8">
                                <div class="row bank-information">
                                    <div class="title col-4 pos-title">
                                        <p>Ngân hàng:</p>
                                    </div>
                                    <div class="payment-information col-8">
                                        <p>Ngân hàng Thương mại Cổ phần Tiên Phong: TPBank</p>
                                    </div>
                                </div>
                                <div class="row bank-information">
                                    <div class="title col-4 pos-title">
                                        <p>Chủ tài khoản:</p>
                                    </div>
                                    <div class="payment-information col-8 uppercase">
                                        <p>Dương thị kim oanh</p>
                                    </div>
                                </div>
                                <div class="row bank-information">
                                    <div class="title col-4 pos-title">
                                        <p>Số tài khoản:</p>
                                    </div>
                                    <div class="payment-information col-8">
                                        <p>30011222333</p>
                                    </div>
                                </div>
                                <div class="row bank-information">
                                    <div class="title col-4 pos-title">
                                        <p>Chi nhánh: </p>
                                    </div>
                                    <div class="payment-information col-8">
                                        <p>CN Đà Nẵng</p>
                                    </div>
                                </div>
                                <div class="row bank-information">
                                    <div class="title col-4 pos-title">
                                        <p>Nội dung: </p>
                                    </div>
                                    <div class="payment-information col-8">
                                        <h4>Nội dung chuyển khoản bạn ghi rõ:</h4>
                                        <h6>NapTienFFM_TenDangNhap_SoDienThoai</h6>
                                        <h6>(vd: NapTienFFM_Truongnq_0975153176)</h6>

                                    </div>
                                </div>
                            </div>


                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>
    <!--    </div>-->
</main>

<footer th:replace="layout :: footer"></footer>
<div th:replace="layout :: js-fragment"></div>

<!--<script th:src="@{/assets/js/bootstrap.min.js}"></script>-->
<!--<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>-->
<!--<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>-->
<!--<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>-->
<!--<script th:src="@{/assets/js/vendor/jquery-1.12.4.min.js}"></script>-->
<script type="text/javascript" th:src="@{/custom-assets/vue-js/profile-user.js}"></script>
<script type="text/javascript" th:src="@{/custom-assets/vue-js/landlord.js}"></script>
</body>
</html>